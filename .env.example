# ===============================
# DATABASE CONFIGURATION
# ===============================
# PostgreSQL connection settings (AWS RDS or local instance)
PGUSER=your-database-username
PGPASSWORD=your-secure-database-password
PGDATABASE=scanner
PGHOST=your-database-host.region.rds.amazonaws.com
PGPORT=5432

# ===============================
# REDIS / CELERY
# ===============================
# Redis connection for Celery message broker and caching
REDIS_URL=redis://redis:6379/0

# ===============================
# MINIO (S3-Compatible Storage)
# ===============================
# MinIO or AWS S3 configuration for audio file storage
MINIO_ENDPOINT=your-minio-host:9000
MINIO_ROOT_USER=your-minio-username
MINIO_ROOT_PASSWORD=your-minio-password
MINIO_BUCKET=feeds
MINIO_USE_SSL=false

# ===============================
# MEILISEARCH (Full-text search)
# ===============================
# MeiliSearch connection for transcript indexing
MEILI_HOST=http://meilisearch:7700
MEILI_MASTER_KEY=your-meili-master-key

# ===============================
# WHISPER (Transcription Model)
# ===============================
# OpenAI Whisper transcription configuration
WHISPER_MODEL=small                    # Options: tiny, base, small, medium, large
LANGUAGE=en                            # Transcription language code
OPENAI_API_KEY=sk-your-openai-api-key-here  # Optional: for OpenAI API instead of local Whisper

# ===============================
# BROADCASTIFY AUTH (JWT)
# ===============================
# Broadcastify API credentials - Sign up at https://www.broadcastify.com/api
BCFY_BASE_URL=https://api.bcfy.io

# The public keys/IDs from your Broadcastify account
BCFY_APP_ID=your-app-id-here
BCFY_API_KEY_ID=your-api-key-id-here
BCFY_API_KEY=your-api-key-here
BCFY_JWT_TOKEN=                        # optional, leave blank; will be auto-fetched

# Filters - Comma-separated country/state codes to limit feed polling
BCFY_COUNTRY_CODES=
BCFY_STATE_CODES=

# (Optional) caching interval controls for the scheduler
BCFY_REFRESH_COMMON_HOURS=24           # How often to refresh geographic data (hours)
BCFY_REFRESH_FEEDS_MINUTES=60          # How often to refresh feed list (minutes)
BCFY_REFRESH_CALLS_MINUTES=5           # How often to poll for new calls (minutes)

# ===============================
# COLLECTOR CONFIG
# ===============================
# Specific feed IDs to monitor (comma-separated)
BROADCASTIFY_FEED_IDS=12345
COLLECT_INTERVAL_SEC=15                # Polling interval (min: 5 seconds for Live API)

# ===============================
# OTHER GLOBALS
# ===============================
COMPOSE_PROJECT_NAME=scanner

# ===============================
# API SERVICE CONFIGURATION
# ===============================
# FastAPI server configuration
API_HOST=0.0.0.0
API_PORT=8000
CORS_ORIGINS=http://localhost:3000,http://localhost:80,http://localhost
LOG_LEVEL=INFO                         # Options: DEBUG, INFO, WARNING, ERROR

# ===============================
# API CACHE TTLs (seconds)
# ===============================
# Time-to-live for various cached data
CACHE_DASHBOARD_TTL=30                 # Dashboard metrics cache (30 seconds)
CACHE_GEOGRAPHY_TTL=3600               # Geographic data cache (1 hour)
CACHE_PLAYLISTS_TTL=300                # Feed list cache (5 minutes)

# ===============================
# AUDIO PROCESSING ENHANCEMENT
# ===============================

# Target loudness (LUFS) - optimized for Whisper transcription accuracy
AUDIO_TARGET_DB=-16

# Processing quality thresholds (0-100 scale)
AUDIO_QUALITY_THRESHOLD_HIGH=70        # Above this: Tier 1 (clean audio, minimal processing)
AUDIO_QUALITY_THRESHOLD_LOW=40         # Below this: Tier 3 (poor audio, aggressive enhancement)

# Noise reduction strength (0.0-1.0)
AUDIO_DENOISE_STRENGTH=0.85

# Speech frequency band (Hz)
AUDIO_HIGHPASS_FREQ=300                # Remove frequencies below this (eliminate rumble)
AUDIO_LOWPASS_FREQ=3400                # Remove frequencies above this (eliminate hiss)

# Dynamic range compression
AUDIO_COMPRESSION_THRESHOLD=-24        # dB - Start compressing above this level
AUDIO_COMPRESSION_RATIO=4              # Ratio of compression

# Processing safety
AUDIO_CONVERSION_TIMEOUT=60            # Maximum processing time per file (seconds)
AUDIO_VALIDATE_OUTPUT=true             # Enable output file validation

# Logging verbosity
AUDIO_LOG_ANALYSIS=true                # Log audio quality scores and processing decisions
AUDIO_LOG_FILTERS=false                # Log full FFmpeg filter chains (very verbose)

# Feature flag for gradual rollout
AUDIO_USE_ENHANCED_PROCESSING=false    # Enable/disable enhanced audio processing pipeline

# ===============================
# FIREBASE AUTHENTICATION
# ===============================
# Firebase Admin SDK (Backend)
# Download service account JSON from Firebase Console > Project Settings > Service Accounts
FIREBASE_SERVICE_ACCOUNT_PATH=/opt/policescanner/secrets/firebase-service-account.json

# Session Cookie Configuration
SESSION_COOKIE_NAME=scanner_session
SESSION_COOKIE_SECURE=true             # Set to false for local development without HTTPS
SESSION_COOKIE_HTTPONLY=true           # Always true - protects against XSS
SESSION_COOKIE_SAMESITE=lax            # Options: lax, strict, none
SESSION_COOKIE_MAX_AGE=604800          # Session duration in seconds (7 days)

# Admin seeding - first user with this email becomes admin
ADMIN_EMAIL=your-admin@example.com

# Firebase Client (Frontend) - Get these from Firebase Console > Project Settings > General
VITE_FIREBASE_API_KEY=your-firebase-api-key
VITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your-project-id
